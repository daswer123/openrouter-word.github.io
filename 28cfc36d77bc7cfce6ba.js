/*! For license information please see 28cfc36d77bc7cfce6ba.js.LICENSE.txt */
function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _createForOfIteratorHelper(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){i=!0,a=t},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var a=e&&e.prototype instanceof g?e:g,c=Object.create(a.prototype),i=new B(r||[]);return o(c,"_invoke",{value:_(t,n,i)}),c}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var d="suspendedStart",m="suspendedYield",f="executing",h="completed",y={};function g(){}function v(){}function x(){}var b={};u(b,c,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(O([])));E&&E!==n&&r.call(E,c)&&(b=E);var w=x.prototype=g.prototype=Object.create(b);function I(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(o,a,c,i){var l=p(t[o],t,a);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==_typeof(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){n("next",t,c,i)}),(function(t){n("throw",t,c,i)})):e.resolve(s).then((function(t){u.value=t,c(u)}),(function(t){return n("throw",t,c,i)}))}i(l.arg)}var a;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,n,r){var o=d;return function(a,c){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw c;return{value:t,done:!0}}for(r.method=a,r.arg=c;;){var i=r.delegate;if(i){var l=T(i,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var u=p(e,n,r);if("normal"===u.type){if(o=r.done?h:m,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=h,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=p(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var c=a.arg;return c?c.done?(n[e.resultName]=c.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(_typeof(e)+" is not iterable")}return v.prototype=x,o(w,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:v,configurable:!0}),v.displayName=u(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,l,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},I(P.prototype),u(P.prototype,i,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var c=new P(s(t,n,r,o),a);return e.isGeneratorFunction(n)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},I(w),u(w,l,"Generator"),u(w,c,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return i.type="throw",i.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a],i=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var l=r.call(c,"catchLoc"),u=r.call(c,"finallyLoc");if(l&&u){if(this.prev<c.catchLoc)return o(c.catchLoc,!0);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(l){if(this.prev<c.catchLoc)return o(c.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var c=a?a.completion:{};return c.type=t,c.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(t,e,n,r,o,a,c){try{var i=t[a](c),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function c(t){asyncGeneratorStep(a,r,o,c,i,"next",t)}function i(t){asyncGeneratorStep(a,r,o,c,i,"throw",t)}c(void 0)}))}}function getPrompts(){return JSON.parse(localStorage.getItem("prompts")||"[]")}function savePrompts(t){localStorage.setItem("prompts",JSON.stringify(t))}function getLastSelectedPromptIndex(){return parseInt(localStorage.getItem("lastSelectedPromptIndex")||"-1",10)}function saveLastSelectedPromptIndex(t){localStorage.setItem("lastSelectedPromptIndex",t.toString())}function initSettings(){document.getElementById("settings").innerHTML='\n        <div class="mt-3">\n            <label for="api-key" class="form-label">API Ключ:</label>\n            <input type="password" id="api-key" class="form-control">\n        </div>\n    ',document.getElementById("api-key").onchange=saveApiKey,loadModels(),loadSettings()}function populateModelSelect(t){var e=document.getElementById("prompt-model");e.innerHTML="",t.forEach((function(t){var n=document.createElement("option");n.value=t.id,n.textContent=t.name,e.appendChild(n)}))}function saveApiKey(){var t=document.getElementById("api-key").value;localStorage.setItem("apiKey",t)}function loadSettings(){var t=localStorage.getItem("apiKey")||"";document.getElementById("api-key").value=t}var OPENROUTER_BASE_URL="https://openrouter.ai/api/v1";function loadModels(){return _loadModels.apply(this,arguments)}function _loadModels(){return(_loadModels=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var e,n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("".concat(OPENROUTER_BASE_URL,"/models"));case 3:e=t.sent,n=e.data.data,localStorage.setItem("models",JSON.stringify(n)),populateModelSelect(n),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Error loading models:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}function generateTextWithAI(t,e,n){return _generateTextWithAI.apply(this,arguments)}function _generateTextWithAI(){return(_generateTextWithAI=_asyncToGenerator(_regeneratorRuntime().mark((function t(e,n,r){var o,a,c;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=localStorage.getItem("apiKey"),t.prev=1,t.next=4,fetch("".concat(OPENROUTER_BASE_URL,"/chat/completions"),{method:"POST",signal:r,headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json","HTTP-Referer":"https://www.office.com","X-Title":"Word AI Assistant"},body:JSON.stringify({model:n,messages:[{role:"user",content:e}]})});case 4:if((a=t.sent).ok){t.next=7;break}throw new Error("HTTP error! status: ".concat(a.status));case 7:return t.next=9,a.json();case 9:return c=t.sent,t.abrupt("return",c.choices[0].message.content.trim());case 13:throw t.prev=13,t.t0=t.catch(1),console.error("Error in generateTextWithAI:",t.t0),t.t0;case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))).apply(this,arguments)}var originalText="",currentController=null,lastSelectedPrompt=null;function initHome(){document.getElementById("home").innerHTML='\n        <select id="prompt-select" class="form-select mt-3"></select>\n        <div id="selected-model" class="mt-2"></div>\n        <button id="replace-text" class="btn btn-primary mt-3" disabled>Заменить выделенный текст</button>\n        <button id="cancel-request" class="btn btn-secondary mt-3" style="display: none;">Отменить запрос</button>\n        <button id="show-selected-text" class="btn btn-info mt-3">Показать информацию о выделенном тексте</button>\n        <div id="selected-text-info" class="mt-3"></div>\n    ',$("#prompt-select").select2({width:"100%",placeholder:"Выберите промпт",templateResult:formatPrompt,templateSelection:formatPromptSelection}),document.getElementById("replace-text").onclick=replaceSelectedText,document.getElementById("cancel-request").onclick=cancelRequest,document.getElementById("show-selected-text").onclick=showSelectedText,updatePromptSelect(),setInterval(checkSelection,1e3)}function formatPrompt(t){if(!t.id)return t.text;var e=getPrompts()[t.id];return $("<span>".concat(e.name," (").concat(e.model,")</span>"))}function formatPromptSelection(t){return t.id?getPrompts()[t.id].name:t.text}function updatePromptSelect(){var t=$("#prompt-select"),e=document.getElementById("selected-model"),n=getPrompts();t.empty(),t.append(new Option("Выберите промпт","",!0,!0));var r=getLastSelectedPromptIndex();n.forEach((function(e,n){var o=new Option(e.name,n,!1,n===r);t.append(o)})),t.trigger("change");var o=r>=0&&r<n.length?r:null;lastSelectedPrompt=null!==o?n[o]:null,e.textContent=lastSelectedPrompt?"Модель: ".concat(lastSelectedPrompt.model):"",document.getElementById("replace-text").disabled=!lastSelectedPrompt,t.on("change",(function(){var t=$(this).val();lastSelectedPrompt=t?n[t]:null,saveLastSelectedPromptIndex(t||-1),e.textContent=lastSelectedPrompt?"Модель: ".concat(lastSelectedPrompt.model):"",document.getElementById("replace-text").disabled=!lastSelectedPrompt}))}function checkSelection(){Word.run(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){var n,r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=e.document.getSelection()).load("text"),t.next=4,e.sync();case 4:r=document.getElementById("replace-text"),n.text.trim().length>0?r.disabled=!1:r.disabled=!0;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function replaceSelectedText(){return _replaceSelectedText.apply(this,arguments)}function _replaceSelectedText(){return _replaceSelectedText=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Word.run(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){var n,r,o;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=e.document.getSelection()).load("text"),t.next=4,e.sync();case 4:if(originalText=n.text,lastSelectedPrompt){t.next=7;break}return t.abrupt("return");case 7:return document.getElementById("replace-text").style.display="none",document.getElementById("cancel-request").style.display="inline-block",t.prev=9,currentController=new AbortController,r="".concat(lastSelectedPrompt.text,'\n\nUser provided the following text: "').concat(originalText,'"'),t.next=14,generateTextWithAI(r,lastSelectedPrompt.model,currentController.signal);case 14:o=t.sent,n.insertText(o+"\n",Word.InsertLocation.replace),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(9),"AbortError"!==t.t0.name&&console.error("Error:",t.t0);case 21:return t.prev=21,document.getElementById("cancel-request").style.display="none",document.getElementById("replace-text").style.display="inline-block",currentController=null,t.finish(21);case 26:case"end":return t.stop()}}),t,null,[[9,18,21,26]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),_replaceSelectedText.apply(this,arguments)}function cancelRequest(){currentController&&(currentController.abort(),document.getElementById("cancel-request").style.display="none",document.getElementById("replace-text").style.display="inline-block")}function formatSpecialWords(t,e,n,r){var o=[],a=[],c=0;return t.forEach((function(t,i){var l={},u=!1,s=t.text.match(/(\u[0-9a-fA-F]{4})(.+)/);if(s){c++;var p=s[2];a.push({id:c,text:p,relatedWordIndex:o.length}),l.text=t.text.replace(s[0],""),l.footnoteId=c,u=!0}else l.text=t.text;var d={};console.log(t.bold),1!=t.bold&&null!==t.bold||(d.bold=!0,u=!0),t.italic&&(d.italic=!0,u=!0),t.underline&&(d.underline=!0,u=!0),t.color!==e&&""!==t.color&&(d.color=t.color,u=!0),t.highlightColor&&null!==t.highlightColor&&(d.highlight=t.highlightColor,u=!0),t.fontName!==n&&""!==t.fontName&&(d.font=t.fontName,u=!0),t.fontSize!=r&&""!==t.fontSize&&null!==t.fontSize&&(d.size=t.fontSize,u=!0),t.hyperlink&&(d.hyperlink=t.hyperlink,u=!0),Object.keys(d).length>0&&(l.formatting=d),u&&o.push(l)})),{formattedText:o,footnotes:a,baseFormatting:{color:e,font:n,size:r}}}function showSelectedText(){return _showSelectedText.apply(this,arguments)}function _showSelectedText(){return _showSelectedText=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){var n,r,o,a,c,i,l,u,s,p,d,m,f,h,y,g,v;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.document.getSelection(),(r=n.getTextRanges([" "],!1)).load("items"),t.next=5,e.sync();case 5:o=[],a={},c={},i={},l=_createForOfIteratorHelper(r.items),t.prev=10,l.s();case 12:if((u=l.n()).done){t.next=23;break}return(s=u.value).load("text, hyperlink"),s.font.load("bold, italic, underline, color, highlightColor, name, size"),(p=s.footnotes).load("items"),t.next=20,e.sync();case 20:s.text.trim()&&(d=s.font.color||"default",m=s.font.name||"default",f=s.font.size||"default",a[d]=(a[d]||0)+1,c[m]=(c[m]||0)+1,i[f]=(i[f]||0)+1,o.push({text:s.text.trim(),bold:null===s.font.bold,italic:s.font.italic,underline:"None"!==s.font.underline,color:d,highlightColor:s.font.highlightColor,hasFootnote:p.items.length>0,fontName:m,fontSize:f,hyperlink:s.hyperlink}));case 21:t.next=12;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(10),l.e(t.t0);case 28:return t.prev=28,l.f(),t.finish(28);case 31:h=Object.entries(a).reduce((function(t,e){return t[1]>e[1]?t:e}))[0],y=Object.entries(c).reduce((function(t,e){return t[1]>e[1]?t:e}))[0],g=Object.entries(i).reduce((function(t,e){return t[1]>e[1]?t:e}))[0],displayWordsInfo(o,h,y,g),v=formatSpecialWords(o,h,y,g),console.log(v);case 37:case"end":return t.stop()}}),t,null,[[10,25,28,31]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),_showSelectedText.apply(this,arguments)}function displayWordsInfo(t,e,n,r){var o=document.getElementById("selected-text-info"),a="<h3>Анализ выделенного текста:</h3>";t.forEach((function(t,o){a+="<h4>Слово ".concat(o+1,": ").concat(t.text,"</h4>"),a+="<p>\n        ".concat(t.bold?"✅":"❌"," Жирный<br>\n        ").concat(t.italic?"✅":"❌"," Курсив<br>\n        ").concat(t.underline?"✅":"❌"," Подчеркнутый<br>\n        ").concat(t.color!==e&&"default"!==t.color?"✅ Особый цвет: ".concat(t.color):"❌ Основной цвет","<br>\n        ").concat(t.highlightColor?"✅ Выделение: ".concat(t.highlightColor):"❌ Без выделения","<br>\n        ").concat(t.hasFootnote?"✅":"❌"," Есть сноска<br>\n        ").concat(t.fontName!==n&&"default"!==t.fontName?"✅ Особый шрифт: ".concat(t.fontName):"❌ Основной шрифт: ".concat(n),"<br>\n        ").concat(t.fontSize!=r&&"default"!==t.fontSize?"✅ Особый размер: ".concat(t.fontSize):"❌ Основной размер: ".concat(r),"<br>\n        ").concat(t.hyperlink?"✅ Ссылка: ".concat(t.hyperlink):"❌ Без ссылки","\n      </p>")})),o.innerHTML=a}function initPrompts(){document.getElementById("prompts").innerHTML='\n        <div class="mt-3">\n            <input type="text" id="prompt-name" class="form-control" placeholder="Название промпта">\n            <select id="prompt-model" class="form-select mt-2"></select>\n            <textarea id="prompt-text" class="form-control mt-2" rows="5" placeholder="Текст промпта"></textarea>\n            <button id="save-prompt" class="btn btn-primary mt-2">Сохранить промпт</button>\n        </div>\n        <div id="prompt-list" class="mt-3"></div>\n    ',$("#prompt-model").select2({width:"100%",placeholder:"Выберите модель"}).on("select2:opening",(function(){setTimeout((function(){$(".select2-search__field").get(0).focus()}),0)})),document.getElementById("save-prompt").onclick=savePrompt,updatePromptList(),populateModelSelect()}function populateModelSelect_2(){var t=$("#prompt-model");JSON.parse(localStorage.getItem("models")||"[]").forEach((function(e){var n=new Option(e.name,e.id,!1,!1);t.append(n)})),t.trigger("change")}function savePrompt(){var t=document.getElementById("prompt-name").value,e=$("#prompt-model").val(),n=document.getElementById("prompt-text").value;if(t&&e&&n){var r=getPrompts();r.push({name:t,model:e,text:n}),savePrompts(r),updatePromptList(),updatePromptSelect(),document.getElementById("prompt-name").value="",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=""}}function updatePromptList(){var t=document.getElementById("prompt-list"),e=getPrompts();t.innerHTML="",e.forEach((function(e,n){var r=document.createElement("div");r.className="mt-2",r.innerHTML="\n            <strong>".concat(e.name,"</strong> (").concat(e.model,')\n            <button class="btn btn-sm btn-primary edit-prompt" data-index="').concat(n,'">Редактировать</button>\n            <button class="btn btn-sm btn-info duplicate-prompt" data-index="').concat(n,'">Дубликат</button>\n            <button class="btn btn-sm btn-danger delete-prompt" data-index="').concat(n,'">Удалить</button>\n        '),t.appendChild(r)})),t.querySelectorAll(".delete-prompt").forEach((function(t){t.onclick=function(){return deletePrompt(t.dataset.index)}})),t.querySelectorAll(".edit-prompt").forEach((function(t){t.onclick=function(){return editPrompt(t.dataset.index)}})),t.querySelectorAll(".duplicate-prompt").forEach((function(t){t.onclick=function(){return duplicatePrompt(t.dataset.index)}}))}function deletePrompt(t){var e=getPrompts();e.splice(t,1),savePrompts(e),updatePromptList(),updatePromptSelect()}function editPrompt(t){var e=getPrompts()[t];document.getElementById("prompt-name").value=e.name,$("#prompt-model").val(e.model).trigger("change"),document.getElementById("prompt-text").value=e.text,document.getElementById("save-prompt").textContent="Обновить промпт",document.getElementById("save-prompt").onclick=function(){updatePrompt(t),document.getElementById("save-prompt").textContent="Сохранить промпт",document.getElementById("save-prompt").onclick=savePrompt}}function updatePrompt(t){var e=document.getElementById("prompt-name").value,n=$("#prompt-model").val(),r=document.getElementById("prompt-text").value;if(e&&n&&r){var o=getPrompts();o[t]={name:e,model:n,text:r},savePrompts(o),updatePromptList(),updatePromptSelect(),document.getElementById("prompt-name").value="",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=""}}function duplicatePrompt(t){var e=getPrompts()[t];document.getElementById("prompt-name").value=e.name+" (копия)",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=e.text,document.getElementById("save-prompt").textContent="Сохранить промпт",document.getElementById("save-prompt").onclick=savePrompt}Office.onReady((function(t){t.host===Office.HostType.Word&&(initHome(),initPrompts(),initSettings())}));