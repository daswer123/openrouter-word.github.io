{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./node_modules/html-loader/dist/runtime/getUrl.js","webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/compat get default export","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  }\n  if (!url) {\n    return url;\n  }\n\n  // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n  url = String(url.__esModule ? url.default : url);\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  }\n  if (options.maybeNeedQuotes && /[\\t\\n\\f\\r \"'=<>`]/.test(url)) {\n    return \"\\\"\".concat(url, \"\\\"\");\n  }\n  return url;\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function"," function getPrompts() {\r\n    return JSON.parse(localStorage.getItem('prompts') || '[]');\r\n}\r\n\r\n function savePrompts(prompts) {\r\n    localStorage.setItem('prompts', JSON.stringify(prompts));\r\n}\r\n\r\n function getLastSelectedPromptIndex() {\r\n    return parseInt(localStorage.getItem('lastSelectedPromptIndex') || '-1', 10);\r\n}\r\n\r\n function saveLastSelectedPromptIndex(index) {\r\n    localStorage.setItem('lastSelectedPromptIndex', index.toString());\r\n}\r\n\r\n\r\n\r\n function initSettings() {\r\n    const settingsTab = document.getElementById('settings');\r\n    settingsTab.innerHTML = `\r\n        <div class=\"mt-3\">\r\n            <label for=\"api-key\" class=\"form-label\">API Ключ:</label>\r\n            <input type=\"password\" id=\"api-key\" class=\"form-control\">\r\n        </div>\r\n    `;\r\n\r\n    document.getElementById('api-key').onchange = saveApiKey;\r\n    loadModels();\r\n    loadSettings();\r\n}\r\n\r\n function populateModelSelect(models) {\r\n    const select = document.getElementById('prompt-model');\r\n    select.innerHTML = '';\r\n    models.forEach(model => {\r\n        const option = document.createElement('option');\r\n        option.value = model.id;\r\n        option.textContent = model.name;\r\n        select.appendChild(option);\r\n    });\r\n}\r\n\r\nfunction saveApiKey() {\r\n    const apiKey = document.getElementById('api-key').value;\r\n    localStorage.setItem('apiKey', apiKey);\r\n}\r\n\r\nfunction loadSettings() {\r\n    const apiKey = localStorage.getItem('apiKey') || '';\r\n    document.getElementById('api-key').value = apiKey;\r\n}\r\n\r\n\r\n\r\n\r\nconst OPENROUTER_BASE_URL = \"https://openrouter.ai/api/v1\";\r\n\r\n async function loadModels() {\r\n    try {\r\n        const response = await axios.get(`${OPENROUTER_BASE_URL}/models`);\r\n        const models = response.data.data;\r\n        localStorage.setItem('models', JSON.stringify(models));\r\n        populateModelSelect(models);\r\n    } catch (error) {\r\n        console.error('Error loading models:', error);\r\n    }\r\n}\r\n\r\n async function generateTextWithAI(prompt, model, signal) {\r\n    const apiKey = localStorage.getItem('apiKey');\r\n\r\n    try {\r\n        const response = await fetch(`${OPENROUTER_BASE_URL}/chat/completions`, {\r\n            method: 'POST',\r\n            signal,\r\n            headers: {\r\n                'Authorization': `Bearer ${apiKey}`,\r\n                'Content-Type': 'application/json',\r\n                'HTTP-Referer': 'https://www.office.com',\r\n                'X-Title': 'Word AI Assistant',\r\n            },\r\n            body: JSON.stringify({\r\n                model: model,\r\n                messages: [{ role: \"user\", content: prompt }],\r\n            }),\r\n        });\r\n\r\n        if (!response.ok) {\r\n            throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        return data.choices[0].message.content.trim();\r\n    } catch (error) {\r\n        console.error('Error in generateTextWithAI:', error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nlet originalText = \"\";\r\nlet currentController = null;\r\nlet lastSelectedPrompt = null;\r\n\r\n function initHome() {\r\n    const homeTab = document.getElementById('home');\r\n    homeTab.innerHTML = `\r\n        <select id=\"prompt-select\" class=\"form-select mt-3\"></select>\r\n        <div id=\"selected-model\" class=\"mt-2\"></div>\r\n        <button id=\"replace-text\" class=\"btn btn-primary mt-3\" disabled>Заменить выделенный текст</button>\r\n        <button id=\"cancel-request\" class=\"btn btn-secondary mt-3\" style=\"display: none;\">Отменить запрос</button>\r\n        <button id=\"show-selected-text\" class=\"btn btn-info mt-3\">Показать информацию о выделенном тексте</button>\r\n        <div id=\"selected-text-info\" class=\"mt-3\"></div>\r\n    `;\r\n\r\n    $('#prompt-select').select2({\r\n        width: '100%',\r\n        placeholder: 'Выберите промпт',\r\n        templateResult: formatPrompt,\r\n        templateSelection: formatPromptSelection,\r\n    });\r\n\r\n    document.getElementById(\"replace-text\").onclick = replaceSelectedText;\r\n    document.getElementById(\"cancel-request\").onclick = cancelRequest;\r\n    document.getElementById(\"show-selected-text\").onclick = showSelectedText;\r\n\r\n    updatePromptSelect();\r\n    setInterval(checkSelection, 1000);\r\n}\r\n\r\nfunction formatPrompt(prompt) {\r\n    if (!prompt.id) {\r\n        return prompt.text;\r\n    }\r\n    const prompts = getPrompts();\r\n    const promptData = prompts[prompt.id];\r\n    return $(`<span>${promptData.name} (${promptData.model})</span>`);\r\n}\r\n\r\nfunction formatPromptSelection(prompt) {\r\n    if (!prompt.id) {\r\n        return prompt.text;\r\n    }\r\n    const prompts = getPrompts();\r\n    const promptData = prompts[prompt.id];\r\n    return promptData.name;\r\n}\r\n\r\n function updatePromptSelect() {\r\n    const select = $('#prompt-select');\r\n    const modelDiv = document.getElementById('selected-model');\r\n    const prompts = getPrompts();\r\n    select.empty();\r\n    select.append(new Option('Выберите промпт', '', true, true));\r\n    const lastSelectedPromptIndex = getLastSelectedPromptIndex();\r\n    prompts.forEach((prompt, index) => {\r\n        const option = new Option(prompt.name, index, false, index === lastSelectedPromptIndex);\r\n        select.append(option);\r\n    });\r\n    select.trigger('change');\r\n    const promptIndex = lastSelectedPromptIndex >= 0 && lastSelectedPromptIndex < prompts.length ? lastSelectedPromptIndex : null;\r\n    lastSelectedPrompt = promptIndex !== null ? prompts[promptIndex] : null;\r\n    modelDiv.textContent = lastSelectedPrompt ? `Модель: ${lastSelectedPrompt.model}` : '';\r\n    document.getElementById(\"replace-text\").disabled = !lastSelectedPrompt;\r\n    select.on('change', function() {\r\n        const newPromptIndex = $(this).val();\r\n        lastSelectedPrompt = newPromptIndex ? prompts[newPromptIndex] : null;\r\n        saveLastSelectedPromptIndex(newPromptIndex || -1);\r\n        modelDiv.textContent = lastSelectedPrompt ? `Модель: ${lastSelectedPrompt.model}` : '';\r\n        document.getElementById(\"replace-text\").disabled = !lastSelectedPrompt;\r\n    });\r\n}\r\n\r\nfunction checkSelection() {\r\n    Word.run(async (context) => {\r\n        const selection = context.document.getSelection();\r\n        selection.load(\"text\");\r\n        await context.sync();\r\n\r\n        const replaceButton = document.getElementById(\"replace-text\");\r\n        if (selection.text.trim().length > 0) {\r\n            replaceButton.disabled = false;\r\n        } else {\r\n            replaceButton.disabled = true;\r\n        }\r\n    });\r\n}\r\n\r\nasync function replaceSelectedText() {\r\n    Word.run(async (context) => {\r\n        const selection = context.document.getSelection();\r\n        selection.load(\"text\");\r\n        await context.sync();\r\n\r\n        originalText = selection.text;\r\n\r\n        if (!lastSelectedPrompt) return;\r\n\r\n        document.getElementById(\"replace-text\").style.display = \"none\";\r\n        document.getElementById(\"cancel-request\").style.display = \"inline-block\";\r\n\r\n        try {\r\n            currentController = new AbortController();\r\n            const fullPrompt = `${lastSelectedPrompt.text}\\n\\nUser provided the following text: \"${originalText}\"`;\r\n            const generatedText = await generateTextWithAI(fullPrompt, lastSelectedPrompt.model, currentController.signal);\r\n            selection.insertText(generatedText + '\\n', Word.InsertLocation.replace);\r\n        } catch (error) {\r\n            if (error.name !== 'AbortError') {\r\n                console.error('Error:', error);\r\n            }\r\n        } finally {\r\n            document.getElementById(\"cancel-request\").style.display = \"none\";\r\n            document.getElementById(\"replace-text\").style.display = \"inline-block\";\r\n            currentController = null;\r\n        }\r\n    });\r\n}\r\n\r\nfunction cancelRequest() {\r\n    if (currentController) {\r\n        currentController.abort();\r\n        document.getElementById(\"cancel-request\").style.display = \"none\";\r\n        document.getElementById(\"replace-text\").style.display = \"inline-block\";\r\n    }\r\n}\r\n\r\nfunction formatSpecialWords(wordsInfo, baseColor, baseFont, baseSize) {\r\n    let formattedText = [];\r\n    let footnotes = [];\r\n    let footnoteCounter = 0;\r\n  \r\n    wordsInfo.forEach((word, index) => {\r\n      let wordData = {};\r\n      let hasSpecialFormatting = false;\r\n  \r\n      // Проверка на сноску\r\n      const footnoteMatch = word.text.match(/(\\u[0-9a-fA-F]{4})(.+)/);\r\n      if (footnoteMatch) {\r\n        footnoteCounter++;\r\n        const footnoteText = footnoteMatch[2];\r\n  \r\n        footnotes.push({\r\n          id: footnoteCounter,\r\n          text: footnoteText,\r\n          relatedWordIndex: formattedText.length\r\n        });\r\n  \r\n        wordData.text = word.text.replace(footnoteMatch[0], '');\r\n        wordData.footnoteId = footnoteCounter;\r\n        hasSpecialFormatting = true;\r\n      } else {\r\n        wordData.text = word.text;\r\n      }\r\n  \r\n      let formatting = {};\r\n      \r\n      console.log(word.bold)\r\n      if (word.bold == true || word.bold === null ) {\r\n        formatting.bold = true;\r\n        hasSpecialFormatting = true;\r\n      }\r\n      if (word.italic) {\r\n        formatting.italic = true;\r\n        hasSpecialFormatting = true;\r\n      }\r\n      if (word.underline) {\r\n        formatting.underline = true;\r\n        hasSpecialFormatting = true;\r\n      }\r\n      if (word.color !== baseColor && word.color !== \"\") {\r\n        formatting.color = word.color;\r\n        hasSpecialFormatting = true;\r\n      }\r\n      if (word.highlightColor && word.highlightColor !== null) {\r\n        formatting.highlight = word.highlightColor;\r\n        hasSpecialFormatting = true;\r\n      }\r\n      if (word.fontName !== baseFont && word.fontName !== \"\") {\r\n        formatting.font = word.fontName;\r\n        hasSpecialFormatting = true;\r\n      }\r\n      if (word.fontSize != baseSize && word.fontSize !== \"\" && word.fontSize !== null) {\r\n        formatting.size = word.fontSize;\r\n        hasSpecialFormatting = true;\r\n      }\r\n      if (word.hyperlink) {\r\n        formatting.hyperlink = word.hyperlink;\r\n        hasSpecialFormatting = true;\r\n      }\r\n  \r\n      if (Object.keys(formatting).length > 0) {\r\n        wordData.formatting = formatting;\r\n      }\r\n  \r\n      if (hasSpecialFormatting) {\r\n        formattedText.push(wordData);\r\n      }\r\n    });\r\n  \r\n    return {\r\n      formattedText: formattedText,\r\n      footnotes: footnotes,\r\n      baseFormatting: {\r\n        color: baseColor,\r\n        font: baseFont,\r\n        size: baseSize\r\n      }\r\n    };\r\n  }\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  async function showSelectedText() {\r\n    await Word.run(async (context) => {\r\n      const selection = context.document.getSelection();\r\n      const ranges = selection.getTextRanges([\" \"], false);\r\n      ranges.load(\"items\");\r\n  \r\n      await context.sync();\r\n  \r\n      let wordsInfo = [];\r\n      let colorCounts = {};\r\n      let fontCounts = {};\r\n      let sizeCounts = {};\r\n  \r\n      for (let range of ranges.items) {\r\n        range.load(\"text, hyperlink\");\r\n        range.font.load(\"bold, italic, underline, color, highlightColor, name, size\");\r\n  \r\n        const footnotes = range.footnotes;\r\n        footnotes.load(\"items\");\r\n  \r\n        await context.sync();\r\n  \r\n        if (range.text.trim()) {\r\n          const color = range.font.color || \"default\";\r\n          const font = range.font.name || \"default\";\r\n          const size = range.font.size || \"default\";\r\n  \r\n          colorCounts[color] = (colorCounts[color] || 0) + 1;\r\n          fontCounts[font] = (fontCounts[font] || 0) + 1;\r\n          sizeCounts[size] = (sizeCounts[size] || 0) + 1;\r\n\r\n            \r\n\r\n        //   console.log(range.font.underline)\r\n  \r\n          wordsInfo.push({\r\n            text: range.text.trim(),\r\n            bold: range.font.bold === null,\r\n            italic: range.font.italic,\r\n            underline: range.font.underline !== \"None\",\r\n            color: color,\r\n            highlightColor: range.font.highlightColor,\r\n            hasFootnote: footnotes.items.length > 0,\r\n            fontName: font,\r\n            fontSize: size,\r\n            hyperlink: range.hyperlink\r\n          });\r\n        }\r\n      }\r\n  \r\n      const baseColor = Object.entries(colorCounts).reduce((a, b) => a[1] > b[1] ? a : b)[0];\r\n      const baseFont = Object.entries(fontCounts).reduce((a, b) => a[1] > b[1] ? a : b)[0];\r\n      const baseSize = Object.entries(sizeCounts).reduce((a, b) => a[1] > b[1] ? a : b)[0];\r\n  \r\n      displayWordsInfo(wordsInfo, baseColor, baseFont, baseSize);\r\n      const formatedMassive = formatSpecialWords(wordsInfo, baseColor, baseFont, baseSize)\r\n      console.log(formatedMassive)\r\n    });\r\n  }\r\n  \r\n  function displayWordsInfo(wordsInfo, baseColor, baseFont, baseSize) {\r\n    const infoDiv = document.getElementById(\"selected-text-info\");\r\n    let html = \"<h3>Анализ выделенного текста:</h3>\";\r\n  \r\n    wordsInfo.forEach((word, index) => {\r\n      html += `<h4>Слово ${index + 1}: ${word.text}</h4>`;\r\n      html += `<p>\r\n        ${word.bold ? \"✅\" : \"❌\"} Жирный<br>\r\n        ${word.italic ? \"✅\" : \"❌\"} Курсив<br>\r\n        ${word.underline ? \"✅\" : \"❌\"} Подчеркнутый<br>\r\n        ${word.color !== baseColor && word.color !== \"default\" ? `✅ Особый цвет: ${word.color}` : \"❌ Основной цвет\"}<br>\r\n        ${word.highlightColor ? `✅ Выделение: ${word.highlightColor}` : \"❌ Без выделения\"}<br>\r\n        ${word.hasFootnote ? \"✅\" : \"❌\"} Есть сноска<br>\r\n        ${word.fontName !== baseFont && word.fontName !== \"default\" ? `✅ Особый шрифт: ${word.fontName}` : `❌ Основной шрифт: ${baseFont}`}<br>\r\n        ${word.fontSize != baseSize && word.fontSize !== \"default\" ? `✅ Особый размер: ${word.fontSize}` : `❌ Основной размер: ${baseSize}`}<br>\r\n        ${word.hyperlink ? `✅ Ссылка: ${word.hyperlink}` : \"❌ Без ссылки\"}\r\n      </p>`;\r\n    });\r\n  \r\n    infoDiv.innerHTML = html;\r\n  }\r\n  \r\n  \r\n  \r\n  \r\n\r\n\r\n\r\n function initPrompts() {\r\n    const promptsTab = document.getElementById('prompts');\r\n    promptsTab.innerHTML = `\r\n        <div class=\"mt-3\">\r\n            <input type=\"text\" id=\"prompt-name\" class=\"form-control\" placeholder=\"Название промпта\">\r\n            <select id=\"prompt-model\" class=\"form-select mt-2\"></select>\r\n            <textarea id=\"prompt-text\" class=\"form-control mt-2\" rows=\"5\" placeholder=\"Текст промпта\"></textarea>\r\n            <button id=\"save-prompt\" class=\"btn btn-primary mt-2\">Сохранить промпт</button>\r\n        </div>\r\n        <div id=\"prompt-list\" class=\"mt-3\"></div>\r\n    `;\r\n\r\n    $('#prompt-model').select2({\r\n        width: '100%',\r\n        placeholder: 'Выберите модель',\r\n    }).on('select2:opening', function() {\r\n        setTimeout(() => {\r\n            $('.select2-search__field').get(0).focus();\r\n        }, 0);\r\n    });\r\n\r\n    document.getElementById(\"save-prompt\").onclick = savePrompt;\r\n    updatePromptList();\r\n    populateModelSelect();\r\n}\r\n\r\nfunction populateModelSelect_2() {\r\n    const select = $('#prompt-model');\r\n    const models = JSON.parse(localStorage.getItem('models') || '[]');\r\n    models.forEach(model => {\r\n        const option = new Option(model.name, model.id, false, false);\r\n        select.append(option);\r\n    });\r\n    select.trigger('change');\r\n}\r\n\r\nfunction savePrompt() {\r\n    const name = document.getElementById('prompt-name').value;\r\n    const model = $('#prompt-model').val();\r\n    const text = document.getElementById('prompt-text').value;\r\n    if (name && model && text) {\r\n        const prompts = getPrompts();\r\n        prompts.push({ name, model, text });\r\n        savePrompts(prompts);\r\n        updatePromptList();\r\n        updatePromptSelect();\r\n        document.getElementById('prompt-name').value = '';\r\n        $('#prompt-model').val(null).trigger('change');\r\n        document.getElementById('prompt-text').value = '';\r\n    }\r\n}\r\n\r\nfunction updatePromptList() {\r\n    const list = document.getElementById('prompt-list');\r\n    const prompts = getPrompts();\r\n    list.innerHTML = '';\r\n    prompts.forEach((prompt, index) => {\r\n        const div = document.createElement('div');\r\n        div.className = 'mt-2';\r\n        div.innerHTML = `\r\n            <strong>${prompt.name}</strong> (${prompt.model})\r\n            <button class=\"btn btn-sm btn-primary edit-prompt\" data-index=\"${index}\">Редактировать</button>\r\n            <button class=\"btn btn-sm btn-info duplicate-prompt\" data-index=\"${index}\">Дубликат</button>\r\n            <button class=\"btn btn-sm btn-danger delete-prompt\" data-index=\"${index}\">Удалить</button>\r\n        `;\r\n        list.appendChild(div);\r\n    });\r\n\r\n    list.querySelectorAll('.delete-prompt').forEach(button => {\r\n        button.onclick = () => deletePrompt(button.dataset.index);\r\n    });\r\n\r\n    list.querySelectorAll('.edit-prompt').forEach(button => {\r\n        button.onclick = () => editPrompt(button.dataset.index);\r\n    });\r\n\r\n    list.querySelectorAll('.duplicate-prompt').forEach(button => {\r\n        button.onclick = () => duplicatePrompt(button.dataset.index);\r\n    });\r\n}\r\n\r\nfunction deletePrompt(index) {\r\n    const prompts = getPrompts();\r\n    prompts.splice(index, 1);\r\n    savePrompts(prompts);\r\n    updatePromptList();\r\n    updatePromptSelect();\r\n}\r\n\r\nfunction editPrompt(index) {\r\n    const prompts = getPrompts();\r\n    const prompt = prompts[index];\r\n    document.getElementById('prompt-name').value = prompt.name;\r\n    $('#prompt-model').val(prompt.model).trigger('change');\r\n    document.getElementById('prompt-text').value = prompt.text;\r\n    document.getElementById('save-prompt').textContent = 'Обновить промпт';\r\n    document.getElementById('save-prompt').onclick = () => {\r\n        updatePrompt(index);\r\n        document.getElementById('save-prompt').textContent = 'Сохранить промпт';\r\n        document.getElementById('save-prompt').onclick = savePrompt;\r\n    };\r\n}\r\n\r\nfunction updatePrompt(index) {\r\n    const name = document.getElementById('prompt-name').value;\r\n    const model = $('#prompt-model').val();\r\n    const text = document.getElementById('prompt-text').value;\r\n    if (name && model && text) {\r\n        const prompts = getPrompts();\r\n        prompts[index] = { name, model, text };\r\n        savePrompts(prompts);\r\n        updatePromptList();\r\n        updatePromptSelect();\r\n        document.getElementById('prompt-name').value = '';\r\n        $('#prompt-model').val(null).trigger('change');\r\n        document.getElementById('prompt-text').value = '';\r\n    }\r\n}\r\n\r\nfunction duplicatePrompt(index) {\r\n    const prompts = getPrompts();\r\n    const prompt = prompts[index];\r\n    document.getElementById('prompt-name').value = prompt.name + ' (копия)';\r\n    $('#prompt-model').val(null).trigger('change');\r\n    document.getElementById('prompt-text').value = prompt.text;\r\n    document.getElementById('save-prompt').textContent = 'Сохранить промпт';\r\n    document.getElementById('save-prompt').onclick = savePrompt;\r\n}\r\n\r\n\r\n\r\n\r\n// \r\n\r\nOffice.onReady((info) => {\r\n    if (info.host === Office.HostType.Word) {\r\n        initHome();\r\n        initPrompts();\r\n        initSettings();\r\n    }\r\n});\r\n\r\n\r\n// Also add on loaded webpage\r\n//\r\n// document.addEventListener(\"DOMContentLoaded\", function () {\r\n//     initHome();\r\n//     initPrompts();\r\n//     initSettings();\r\n// });\r\n","// Imports\nimport ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ from \"../../node_modules/html-loader/dist/runtime/getUrl.js\";\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar ___HTML_LOADER_REPLACEMENT_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <title>Замена текста</title> <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css\\\"> <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css\\\"> <link href=\\\"https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css\\\" rel=\\\"stylesheet\\\"/> </head> <body> <div class=\\\"container mt-3\\\"> <ul class=\\\"nav nav-tabs\\\" id=\\\"myTab\\\" role=\\\"tablist\\\"> <li class=\\\"nav-item\\\" role=\\\"presentation\\\"> <a class=\\\"nav-link active\\\" id=\\\"home-tab\\\" data-toggle=\\\"tab\\\" href=\\\"#home\\\" role=\\\"tab\\\" aria-controls=\\\"home\\\" aria-selected=\\\"true\\\">Основное</a> </li> <li class=\\\"nav-item\\\" role=\\\"presentation\\\"> <a class=\\\"nav-link\\\" id=\\\"prompts-tab\\\" data-toggle=\\\"tab\\\" href=\\\"#prompts\\\" role=\\\"tab\\\" aria-controls=\\\"prompts\\\" aria-selected=\\\"false\\\">Промпты</a> </li> <li class=\\\"nav-item\\\" role=\\\"presentation\\\"> <a class=\\\"nav-link\\\" id=\\\"settings-tab\\\" data-toggle=\\\"tab\\\" href=\\\"#settings\\\" role=\\\"tab\\\" aria-controls=\\\"settings\\\" aria-selected=\\\"false\\\">Настройки</a> </li> </ul> <div class=\\\"tab-content\\\" id=\\\"myTabContent\\\"> <div class=\\\"tab-pane fade show active\\\" id=\\\"home\\\" role=\\\"tabpanel\\\" aria-labelledby=\\\"home-tab\\\"></div> <div class=\\\"tab-pane fade\\\" id=\\\"prompts\\\" role=\\\"tabpanel\\\" aria-labelledby=\\\"prompts-tab\\\"></div> <div class=\\\"tab-pane fade\\\" id=\\\"settings\\\" role=\\\"tabpanel\\\" aria-labelledby=\\\"settings-tab\\\"></div> </div> </div> <\" + \"script src=\\\"https://code.jquery.com/jquery-3.5.1.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_REPLACEMENT_0___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["module","exports","url","options","String","__esModule","default","hash","maybeNeedQuotes","test","concat","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","n","getter","d","a","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","i","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","t","r","value","Symbol","iterator","c","asyncIterator","u","toStringTag","define","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","v","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","getPrompts","JSON","parse","localStorage","getItem","savePrompts","prompts","setItem","stringify","initSettings","apiKey","getElementById","innerHTML","onchange","saveApiKey","_loadModels","loadModels","populateModelSelect","models","select","model","option","createElement","id","textContent","appendChild","OPENROUTER_BASE_URL","_callee2","response","_context2","axios","data","t0","console","error","generateTextWithAI","_x","_x2","_x3","_generateTextWithAI","_callee3","prompt","signal","_context3","fetch","headers","body","messages","role","content","ok","status","json","choices","message","trim","originalText","currentController","lastSelectedPrompt","formatPrompt","text","promptData","$","formatPromptSelection","updatePromptSelect","modelDiv","empty","append","Option","lastSelectedPromptIndex","parseInt","index","trigger","promptIndex","disabled","on","newPromptIndex","val","toString","checkSelection","Word","run","_ref","_callee","context","selection","replaceButton","_context","getSelection","load","sync","_x4","replaceSelectedText","_replaceSelectedText","_callee5","_context5","_ref2","_callee4","fullPrompt","generatedText","_context4","style","display","AbortController","insertText","InsertLocation","_x5","cancelRequest","abort","formatSpecialWords","wordsInfo","baseColor","baseFont","baseSize","formattedText","footnotes","footnoteCounter","word","wordData","hasSpecialFormatting","footnoteMatch","match","footnoteText","relatedWordIndex","footnoteId","formatting","log","bold","italic","underline","color","highlightColor","highlight","fontName","font","fontSize","size","hyperlink","baseFormatting","showSelectedText","_showSelectedText","_callee7","_context7","_ref3","_callee6","ranges","colorCounts","fontCounts","sizeCounts","_iterator","_step","range","formatedMassive","_context6","getTextRanges","_createForOfIteratorHelper","items","hasFootnote","entries","reduce","displayWordsInfo","_x6","infoDiv","html","savePrompt","updatePromptList","list","div","className","querySelectorAll","button","onclick","splice","deletePrompt","dataset","updatePrompt","Office","onReady","info","host","HostType","select2","width","placeholder","templateResult","templateSelection","setInterval","setTimeout","focus","___HTML_LOADER_IMPORT_0___","URL"],"sourceRoot":""}