/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var t={14385:function(t){"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},54058:function(t,e,n){"use strict";t.exports=n.p+"add4b8a72efce0d2f28b.js"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return r};var n,r={},o=Object.prototype,a=o.hasOwnProperty,c=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function p(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(n){p=function(t,e,n){return t[e]=n}}function d(t,e,n,r){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),i=new P(r||[]);return c(a,"_invoke",{value:O(t,n,i)}),a}function m(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=d;var f="suspendedStart",h="suspendedYield",y="executing",v="completed",g={};function b(){}function x(){}function w(){}var E={};p(E,l,(function(){return this}));var I=Object.getPrototypeOf,B=I&&I(I(N([])));B&&B!==o&&a.call(B,l)&&(E=B);var S=w.prototype=b.prototype=Object.create(E);function L(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function k(e,n){function r(o,c,i,l){var u=m(e[o],e,c);if("throw"!==u.type){var s=u.arg,p=s.value;return p&&"object"==t(p)&&a.call(p,"__await")?n.resolve(p.__await).then((function(t){r("next",t,i,l)}),(function(t){r("throw",t,i,l)})):n.resolve(p).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,l)}))}l(u.arg)}var o;c(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,o){r(t,e,n,o)}))}return o=o?o.then(a,a):a()}})}function O(t,e,r){var o=f;return function(a,c){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===a)throw c;return{value:n,done:!0}}for(r.method=a,r.arg=c;;){var i=r.delegate;if(i){var l=T(i,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var u=m(t,e,r);if("normal"===u.type){if(o=r.done?v:h,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=v,r.method="throw",r.arg=u.arg)}}}function T(t,e){var r=e.method,o=t.iterator[r];if(o===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,T(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=m(o,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,g;var c=a.arg;return c?c.done?(e[t.resultName]=c.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,g):c:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,c=function t(){for(;++o<e.length;)if(a.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return c.next=c}}throw new TypeError(t(e)+" is not iterable")}return x.prototype=w,c(S,"constructor",{value:w,configurable:!0}),c(w,"constructor",{value:x,configurable:!0}),x.displayName=p(w,s,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,p(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},r.awrap=function(t){return{__await:t}},L(k.prototype),p(k.prototype,u,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,a){void 0===a&&(a=Promise);var c=new k(d(t,e,n,o),a);return r.isGeneratorFunction(e)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},L(S),p(S,s,"Generator"),p(S,l,(function(){return this})),p(S,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=N,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,o){return i.type="throw",i.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var c=this.tryEntries[o],i=c.completion;if("root"===c.tryLoc)return r("end");if(c.tryLoc<=this.prev){var l=a.call(c,"catchLoc"),u=a.call(c,"finallyLoc");if(l&&u){if(this.prev<c.catchLoc)return r(c.catchLoc,!0);if(this.prev<c.finallyLoc)return r(c.finallyLoc)}else if(l){if(this.prev<c.catchLoc)return r(c.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return r(c.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=t,c.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:N(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),g}},r}function n(t,e,n,r,o,a,c){try{var i=t[a](c),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(o,a){var c=t.apply(e,r);function i(t){n(c,o,a,i,l,"next",t)}function l(t){n(c,o,a,i,l,"throw",t)}i(void 0)}))}}function o(){return JSON.parse(localStorage.getItem("prompts")||"[]")}function a(t){localStorage.setItem("prompts",JSON.stringify(t))}function c(){var t;document.getElementById("settings").innerHTML='\n        <div class="mt-3">\n            <label for="api-key" class="form-label">API Ключ:</label>\n            <input type="password" id="api-key" class="form-control">\n        </div>\n    ',document.getElementById("api-key").onchange=l,function(){s.apply(this,arguments)}(),t=localStorage.getItem("apiKey")||"",document.getElementById("api-key").value=t}function i(t){var e=document.getElementById("prompt-model");e.innerHTML="",t.forEach((function(t){var n=document.createElement("option");n.value=t.id,n.textContent=t.name,e.appendChild(n)}))}function l(){var t=document.getElementById("api-key").value;localStorage.setItem("apiKey",t)}var u="https://openrouter.ai/api/v1";function s(){return(s=r(e().mark((function t(){var n,r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("".concat(u,"/models"));case 3:n=t.sent,r=n.data.data,localStorage.setItem("models",JSON.stringify(r)),i(r),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Error loading models:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}function p(t,e,n){return d.apply(this,arguments)}function d(){return(d=r(e().mark((function t(n,r,o){var a,c,i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=localStorage.getItem("apiKey"),t.prev=1,t.next=4,fetch("".concat(u,"/chat/completions"),{method:"POST",signal:o,headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json","HTTP-Referer":"https://www.office.com","X-Title":"Word AI Assistant"},body:JSON.stringify({model:r,messages:[{role:"user",content:n}]})});case 4:if((c=t.sent).ok){t.next=7;break}throw new Error("HTTP error! status: ".concat(c.status));case 7:return t.next=9,c.json();case 9:return i=t.sent,t.abrupt("return",i.choices[0].message.content.trim());case 13:throw t.prev=13,t.t0=t.catch(1),console.error("Error in generateTextWithAI:",t.t0),t.t0;case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))).apply(this,arguments)}var m="",f=null,h=null;function y(t){if(!t.id)return t.text;var e=o()[t.id];return $("<span>".concat(e.name," (").concat(e.model,")</span>"))}function v(t){return t.id?o()[t.id].name:t.text}function g(){var t=$("#prompt-select"),e=document.getElementById("selected-model"),n=o();t.empty(),t.append(new Option("Выберите промпт","",!0,!0));var r=parseInt(localStorage.getItem("lastSelectedPromptIndex")||"-1",10);n.forEach((function(e,n){var o=new Option(e.name,n,!1,n===r);t.append(o)})),t.trigger("change");var a=r>=0&&r<n.length?r:null;h=null!==a?n[a]:null,e.textContent=h?"Модель: ".concat(h.model):"",document.getElementById("replace-text").disabled=!h,t.on("change",(function(){var t,r=$(this).val();h=r?n[r]:null,t=r||-1,localStorage.setItem("lastSelectedPromptIndex",t.toString()),e.textContent=h?"Модель: ".concat(h.model):"",document.getElementById("replace-text").disabled=!h}))}function b(){Word.run(function(){var t=r(e().mark((function t(n){var r,o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=n.document.getSelection()).load("text"),t.next=4,n.sync();case 4:o=document.getElementById("replace-text"),r.text.trim().length>0?o.disabled=!1:o.disabled=!0;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function x(){return w.apply(this,arguments)}function w(){return w=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Word.run(function(){var t=r(e().mark((function t(n){var r,o,a;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=n.document.getSelection()).load("text"),t.next=4,n.sync();case 4:if(m=r.text,h){t.next=7;break}return t.abrupt("return");case 7:return document.getElementById("replace-text").style.display="none",document.getElementById("cancel-request").style.display="inline-block",t.prev=9,f=new AbortController,o="".concat(h.text,'\n\nUser provided the following text: "').concat(m,'"'),t.next=14,p(o,h.model,f.signal);case 14:a=t.sent,r.insertText(a+"\n",Word.InsertLocation.replace),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(9),"AbortError"!==t.t0.name&&console.error("Error:",t.t0);case 21:return t.prev=21,document.getElementById("cancel-request").style.display="none",document.getElementById("replace-text").style.display="inline-block",f=null,t.finish(21);case 26:case"end":return t.stop()}}),t,null,[[9,18,21,26]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}function E(){f&&(f.abort(),document.getElementById("cancel-request").style.display="none",document.getElementById("replace-text").style.display="inline-block")}function I(){var t=document.getElementById("prompt-name").value,e=$("#prompt-model").val(),n=document.getElementById("prompt-text").value;if(t&&e&&n){var r=o();r.push({name:t,model:e,text:n}),a(r),B(),g(),document.getElementById("prompt-name").value="",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=""}}function B(){var t=document.getElementById("prompt-list"),e=o();t.innerHTML="",e.forEach((function(e,n){var r=document.createElement("div");r.className="mt-2",r.innerHTML="\n            <strong>".concat(e.name,"</strong> (").concat(e.model,')\n            <button class="btn btn-sm btn-primary edit-prompt" data-index="').concat(n,'">Редактировать</button>\n            <button class="btn btn-sm btn-info duplicate-prompt" data-index="').concat(n,'">Дубликат</button>\n            <button class="btn btn-sm btn-danger delete-prompt" data-index="').concat(n,'">Удалить</button>\n        '),t.appendChild(r)})),t.querySelectorAll(".delete-prompt").forEach((function(t){t.onclick=function(){return function(t){var e=o();e.splice(t,1),a(e),B(),g()}(t.dataset.index)}})),t.querySelectorAll(".edit-prompt").forEach((function(t){t.onclick=function(){return e=t.dataset.index,n=o()[e],document.getElementById("prompt-name").value=n.name,$("#prompt-model").val(n.model).trigger("change"),document.getElementById("prompt-text").value=n.text,document.getElementById("save-prompt").textContent="Обновить промпт",void(document.getElementById("save-prompt").onclick=function(){!function(t){var e=document.getElementById("prompt-name").value,n=$("#prompt-model").val(),r=document.getElementById("prompt-text").value;if(e&&n&&r){var c=o();c[t]={name:e,model:n,text:r},a(c),B(),g(),document.getElementById("prompt-name").value="",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=""}}(e),document.getElementById("save-prompt").textContent="Сохранить промпт",document.getElementById("save-prompt").onclick=I});var e,n}})),t.querySelectorAll(".duplicate-prompt").forEach((function(t){t.onclick=function(){return e=t.dataset.index,n=o()[e],document.getElementById("prompt-name").value=n.name+" (копия)",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=n.text,document.getElementById("save-prompt").textContent="Сохранить промпт",void(document.getElementById("save-prompt").onclick=I);var e,n}}))}console.log("Привет мир"),Office.onReady((function(t){var e;t.host===Office.HostType.Word&&(document.getElementById("home").innerHTML='\n        <select id="prompt-select" class="form-select mt-3"></select>\n        <div id="selected-model" class="mt-2"></div>\n        <button id="replace-text" class="btn btn-primary mt-3" disabled>Заменить выделенный текст</button>\n        <button id="cancel-request" class="btn btn-secondary mt-3" style="display: none;">Отменить запрос</button>\n    ',$("#prompt-select").select2({width:"100%",placeholder:"Выберите промпт",templateResult:y,templateSelection:v}),document.getElementById("replace-text").onclick=x,document.getElementById("cancel-request").onclick=E,g(),setInterval(b,1e3),document.getElementById("prompts").innerHTML='\n        <div class="mt-3">\n            <input type="text" id="prompt-name" class="form-control" placeholder="Название промпта">\n            <select id="prompt-model" class="form-select mt-2"></select>\n            <textarea id="prompt-text" class="form-control mt-2" rows="5" placeholder="Текст промпта"></textarea>\n            <button id="save-prompt" class="btn btn-primary mt-2">Сохранить промпт</button>\n        </div>\n        <div id="prompt-list" class="mt-3"></div>\n    ',$("#prompt-model").select2({width:"100%",placeholder:"Выберите модель"}).on("select2:opening",(function(){setTimeout((function(){$(".select2-search__field").get(0).focus()}),0)})),document.getElementById("save-prompt").onclick=I,B(),e=$("#prompt-model"),JSON.parse(localStorage.getItem("models")||"[]").forEach((function(t){var n=new Option(t.name,t.id,!1,!1);e.append(n)})),e.trigger("change"),c())}))}(),function(){"use strict";var t=n(14385),e=n.n(t),r=new URL(n(54058),n.b);e()(r)}()}();
//# sourceMappingURL=taskpane.js.map