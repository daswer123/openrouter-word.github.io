/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={14385:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},54058:function(e,t,n){"use strict";e.exports=n.p+"7c4b36bdb698410fc436.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,c=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw c}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(){"use strict";r=function(){return n};var t,n={},o=Object.prototype,a=o.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function m(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),i=new j(r||[]);return c(a,"_invoke",{value:O(e,n,i)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=m;var f="suspendedStart",h="suspendedYield",g="executing",y="completed",v={};function b(){}function x(){}function k(){}var w={};d(w,l,(function(){return this}));var E=Object.getPrototypeOf,I=E&&E(E(A([])));I&&I!==o&&a.call(I,l)&&(w=I);var S=k.prototype=b.prototype=Object.create(w);function B(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function T(t,n){function r(o,c,i,l){var s=p(t[o],t,c);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==e(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):n.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,l)}))}l(s.arg)}var o;c(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(a,a):a()}})}function O(e,n,r){var o=f;return function(a,c){if(o===g)throw Error("Generator is already running");if(o===y){if("throw"===a)throw c;return{value:t,done:!0}}for(r.method=a,r.arg=c;;){var i=r.delegate;if(i){var l=L(i,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=p(e,n,r);if("normal"===s.type){if(o=r.done?y:h,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=y,r.method="throw",r.arg=s.arg)}}}function L(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=p(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var c=a.arg;return c?c.done?(n[e.resultName]=c.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function A(n){if(n||""===n){var r=n[l];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,c=function e(){for(;++o<n.length;)if(a.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return c.next=c}}throw new TypeError(e(n)+" is not iterable")}return x.prototype=k,c(S,"constructor",{value:k,configurable:!0}),c(k,"constructor",{value:x,configurable:!0}),x.displayName=d(k,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,d(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},n.awrap=function(e){return{__await:e}},B(T.prototype),d(T.prototype,s,(function(){return this})),n.AsyncIterator=T,n.async=function(e,t,r,o,a){void 0===a&&(a=Promise);var c=new T(m(e,t,r,o),a);return n.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},B(S),d(S,u,"Generator"),d(S,l,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=A,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return i.type="throw",i.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var c=this.tryEntries[o],i=c.completion;if("root"===c.tryLoc)return r("end");if(c.tryLoc<=this.prev){var l=a.call(c,"catchLoc"),s=a.call(c,"finallyLoc");if(l&&s){if(this.prev<c.catchLoc)return r(c.catchLoc,!0);if(this.prev<c.finallyLoc)return r(c.finallyLoc)}else if(l){if(this.prev<c.catchLoc)return r(c.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return r(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},n}function o(e,t,n,r,o,a,c){try{var i=e[a](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function i(e){o(c,r,a,i,l,"next",e)}function l(e){o(c,r,a,i,l,"throw",e)}i(void 0)}))}}function c(){return JSON.parse(localStorage.getItem("prompts")||"[]")}function i(e){localStorage.setItem("prompts",JSON.stringify(e))}function l(){var e,t,n;document.getElementById("settings").innerHTML='\n        <div class="mt-3">\n            <label for="api-key" class="form-label">API Ключ:</label>\n            <input type="password" id="api-key" class="form-control">\n        </div>\n        <div class="mt-3">\n            <label for="formatting-model" class="form-label">Модель для форматирования:</label>\n            <select id="formatting-model" class="form-select"></select>\n        </div>\n        <div class="mt-3 form-check">\n            <input type="checkbox" class="form-check-input" id="apply-formatting">\n            <label class="form-check-label" for="apply-formatting">Применять форматирование</label>\n        </div>\n    ',document.getElementById("api-key").onchange=m,document.getElementById("formatting-model").onchange=s,document.getElementById("apply-formatting").onchange=u,function(){f.apply(this,arguments)}(),e=localStorage.getItem("apiKey")||"",t=localStorage.getItem("formattingModel")||"openai/gpt-4-mini",n="true"===localStorage.getItem("applyFormatting"),document.getElementById("api-key").value=e,$("#formatting-model").val(t).trigger("change"),document.getElementById("apply-formatting").checked=n,$("#formatting-model").select2({width:"100%",placeholder:"Выберите модель для форматирования"}).on("select2:opening",(function(){setTimeout((function(){$(".select2-search__field").get(0).focus()}),0)}))}function s(){var e=document.getElementById("formatting-model").value;localStorage.setItem("formattingModel",e)}function u(){var e=document.getElementById("apply-formatting").checked;localStorage.setItem("applyFormatting",e)}function d(e){var t=$("#prompt-model"),n=$("#formatting-model");[t,n].forEach((function(t){t.empty(),e.forEach((function(e){var n=new Option(e.name,e.id,!1,!1);t.append(n)})),t.trigger("change")}));var r=e.find((function(e){return"openai/gpt-4-mini"===e.id}))||e[0];r&&n.val(r.id).trigger("change");var o=localStorage.getItem("formattingModel");o&&e.some((function(e){return e.id===o}))&&n.val(o).trigger("change")}function m(){var e=document.getElementById("api-key").value;localStorage.setItem("apiKey",e)}var p="https://openrouter.ai/api/v1";function f(){return(f=a(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("".concat(p,"/models"));case 3:t=e.sent,n=t.data.data,localStorage.setItem("models",JSON.stringify(n)),d(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error loading models:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function h(e,t,n,r){return g.apply(this,arguments)}function g(){return(g=a(r().mark((function e(t,n,o,a){var c,i,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=localStorage.getItem("apiKey"),e.prev=1,e.next=4,fetch("".concat(p,"/chat/completions"),{method:"POST",signal:a,headers:{Authorization:"Bearer ".concat(c),"Content-Type":"application/json","HTTP-Referer":"https://www.office.com","X-Title":"Word AI Assistant"},body:JSON.stringify({model:o,messages:[{role:"system",content:t},{role:"user",content:n}]})});case 4:if((i=e.sent).ok){e.next=7;break}throw new Error("HTTP error! status: ".concat(i.status));case 7:return e.next=9,i.json();case 9:return l=e.sent,e.abrupt("return",l.choices[0].message.content.trim());case 13:throw e.prev=13,e.t0=e.catch(1),console.error("Error in generateTextWithAI:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function y(e,t,n,r){return v.apply(this,arguments)}function v(){return(v=a(r().mark((function e(t,n,o,a){var c,i,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=localStorage.getItem("apiKey"),e.prev=1,e.next=4,fetch("".concat(p,"/chat/completions"),{method:"POST",signal:a,headers:{Authorization:"Bearer ".concat(c),"Content-Type":"application/json","HTTP-Referer":"https://www.office.com","X-Title":"Word AI Assistant"},body:JSON.stringify({model:o,messages:[{role:"system",content:t},{role:"user",content:n}]})});case 4:if((i=e.sent).ok){e.next=7;break}throw new Error("HTTP error! status: ".concat(i.status));case 7:return e.next=9,i.json();case 9:return l=e.sent,e.abrupt("return",l.choices[0].message.content.trim());case 13:throw e.prev=13,e.t0=e.catch(1),console.error("Error in generateTextWithAI:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}var b="",x=null,k=null;function w(){document.getElementById("home").innerHTML='\n      <select id="prompt-select" class="form-select mt-3"></select>\n      <div id="selected-model" class="mt-2"></div>\n      <button id="replace-text" class="btn btn-primary mt-3" disabled>Заменить выделенный текст</button>\n      <button id="cancel-request" class="btn btn-secondary mt-3" style="display: none;">Отменить запрос</button>\n      <button id="show-selected-text" class="btn btn-info mt-3">Показать информацию о выделенном тексте</button>\n      \x3c!-- <button id="apply-tricks" class="btn btn-warning mt-3">Применить приколы</button>\n      <button id="repeat-styles" class="btn btn-primary mt-3">Повтор стилей</button> --\x3e\n      <div id="selected-text-info" class="mt-3"></div>\n  ',$("#prompt-select").select2({width:"100%",placeholder:"Выберите промпт",templateResult:E,templateSelection:I}),document.getElementById("replace-text").onclick=T,document.getElementById("cancel-request").onclick=N,document.getElementById("show-selected-text").onclick=A,S(),setInterval(B,1e3)}function E(e){if(!e.id)return e.text;var t=c()[e.id];return $("<span>".concat(t.name," (").concat(t.model,")</span>"))}function I(e){return e.id?c()[e.id].name:e.text}function S(){var e=$("#prompt-select"),t=document.getElementById("selected-model"),n=c();e.empty(),e.append(new Option("Выберите промпт","",!0,!0));var r=parseInt(localStorage.getItem("lastSelectedPromptIndex")||"-1",10);n.forEach((function(t,n){var o=new Option(t.name,n,!1,n===r);e.append(o)})),e.trigger("change");var o=r>=0&&r<n.length?r:null;k=null!==o?n[o]:null,t.textContent=k?"Модель: ".concat(k.model):"",document.getElementById("replace-text").disabled=!k,e.on("change",(function(){var e,r=$(this).val();k=r?n[r]:null,e=r||-1,localStorage.setItem("lastSelectedPromptIndex",e.toString()),t.textContent=k?"Модель: ".concat(k.model):"",document.getElementById("replace-text").disabled=!k}))}function B(){Word.run(function(){var e=a(r().mark((function e(t){var n,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load("text"),e.next=4,t.sync();case 4:o=document.getElementById("replace-text"),n.text.trim().length>0?o.disabled=!1:o.disabled=!0;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function T(){return O.apply(this,arguments)}function O(){return O=a(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Word.run(function(){var e=a(r().mark((function e(t){var n,o,a,c,i,l,s,u,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load("text"),e.next=4,t.sync();case 4:if(b=n.text,k){e.next=7;break}return e.abrupt("return");case 7:if(document.getElementById("replace-text").style.display="none",document.getElementById("cancel-request").style.display="inline-block",e.prev=9,x=new AbortController,o="true"===localStorage.getItem("applyFormatting"),a=localStorage.getItem("formattingModel")||"openai/gpt-4-mini",c=[],!o){e.next=18;break}return e.next=17,P(t,n);case 17:c=e.sent;case 18:return i="".concat(k.text,'\n\nUser provided the following text: "').concat(b,'"').concat(o?"\n\nFormatting information: ".concat(JSON.stringify(c)):""),e.next=22,h("You are an AI assistant specialized in text processing and formatting. Your task is to generate text based on user prompts and, when required, update formatting information for the generated text. Always provide responses in the requested format.",i,k.model,x.signal);case 22:if(l=e.sent,!o){e.next=44;break}return s='\nOriginal text: "'.concat(b,'"\nModified text: "').concat(l,'"\nOriginal formatting information: ').concat(JSON.stringify(c),'\n\nTask: Update the formatting information to match the new text while preserving the original styles and formats. Return ONLY the updated formatting information array in valid JSON format.\n\nInstructions:\n1. Analyze the original and modified texts.\n2. Create a new array of formatting information for the modified text.\n3. Preserve the original formatting styles as much as possible.\n4. Ensure the number of elements in the array matches the number of words in the modified text.\n5. Return ONLY the JSON array, without any additional text or explanation.\n\nThe JSON array should contain objects with the following possible properties:\n- text: string (required) - the word from the modified text\n- bold: boolean\n- italic: boolean\n- underline: boolean\n- color: string (e.g., "#FF0000" for red)\n- highlightColor: string (e.g., "yellow")\n- size: number\n- fontName: string\n- hyperlink: string (URL)\n- footnoteText: string\n\nExample of a valid response:\n[\n{"text": "This", "bold": true, "color": "#0000FF"},\n{"text": "is", "italic": true},\n{"text": "an", "underline": true},\n{"text": "example", "size": 14, "fontName": "Arial"},\n{"text": "with", "highlightColor": "yellow"},\n{"text": "formatting", "hyperlink": "https://example.com"},\n{"text": "applied", "footnoteText": "This is a footnote example"}\n]\n\nEnsure your response is a valid JSON array and includes formatting information for all words in the modified text.'),e.prev=26,e.next=29,y("You are an AI assistant specialized in text formatting. Your task is to update formatting information for modified text while preserving the original styles as much as possible. Always return your response as a valid JSON array.",s,a,x.signal);case 29:if(d=e.sent,u=JSON.parse(d),Array.isArray(u)){e.next=33;break}throw new Error("Response is not an array");case 33:e.next=40;break;case 35:return e.prev=35,e.t0=e.catch(26),console.error("Error parsing formatting information:",e.t0),n.insertText(l,Word.InsertLocation.replace),e.abrupt("return");case 40:return e.next=42,L(t,n,l,u);case 42:e.next=45;break;case 44:n.insertText(l,Word.InsertLocation.replace);case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(9),"AbortError"!==e.t1.name&&console.error("Error:",e.t1);case 50:return e.prev=50,document.getElementById("cancel-request").style.display="none",document.getElementById("replace-text").style.display="inline-block",x=null,e.finish(50);case 55:case"end":return e.stop()}}),e,null,[[9,47,50,55],[26,35]])})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function L(e,t,n,r){return C.apply(this,arguments)}function C(){return(C=a(r().mark((function e(t,n,o,a){var c,i,l,s,u,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.clear(),e.next=3,t.sync();case 3:c=o.split(/\s+/),i=0,l=0;case 6:if(!(l<c.length)){e.next=16;break}return s=c[l],u=n.insertText(s,Word.InsertLocation.end),i<a.length&&(void 0!==(d=a[i]).bold&&(u.font.bold=d.bold),void 0!==d.italic&&(u.font.italic=d.italic),d.color&&(u.font.color=d.color),d.highlightColor&&(u.font.highlightColor=d.highlightColor),d.size&&(u.font.size=d.size),d.hyperlink&&(u.hyperlink=d.hyperlink),d.footnoteText&&u.insertFootnote().body.insertText(d.footnoteText,Word.InsertLocation.start),i++),l<c.length-1&&n.insertText(" ",Word.InsertLocation.end),e.next=13,t.sync();case 13:l++,e.next=6;break;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){x&&(x.abort(),document.getElementById("cancel-request").style.display="none",document.getElementById("replace-text").style.display="inline-block")}function j(e,t,n,r){var o=[],a=[];return e.forEach((function(e,c){var i={text:e.text},l=!1,s={};!0!==e.bold&&null!==e.bold||(s.bold=!0,l=!0),e.italic&&(s.italic=!0,l=!0),e.underline&&(s.underline=!0,l=!0),e.color!==t&&""!==e.color&&(s.color=e.color,l=!0),e.highlightColor&&null!==e.highlightColor&&(s.highlight=e.highlightColor,l=!0),e.fontName!==n&&""!==e.fontName&&(s.font=e.fontName,l=!0),e.fontSize!=r&&""!==e.fontSize&&null!==e.fontSize&&(s.size=e.fontSize,l=!0),e.hyperlink&&(s.hyperlink=e.hyperlink,l=!0),Object.keys(s).length>0&&(i.formatting=s),e.hasFootnote&&(i.footnoteId=c+1,a.push({id:c+1,text:e.footnoteText,relatedWordIndex:o.length}),l=!0),l&&o.push(i)})),{formattedText:o,footnotes:a,baseFormatting:{color:t,font:n,size:r}}}function A(){return W.apply(this,arguments)}function W(){return W=a(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=a(r().mark((function e(t){var n,o,a,c,i,l,s,u,d,m,p,f,h,g,y,v,b,x;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.document.getSelection(),(o=n.getTextRanges([" "],!1)).load("items"),e.next=5,t.sync();case 5:a=[],c={},i={},l={},s=0;case 10:if(!(s<o.items.length)){e.next=36;break}return(u=o.items[s]).load("text, hyperlink"),u.font.load("bold, italic, underline, color, highlightColor, name, size"),(d=u.footnotes).load("items"),e.next=18,t.sync();case 18:if(!u.text.trim()){e.next=33;break}if(m=u.font.color||"default",p=u.font.name||"default",f=u.font.size||"default",c[m]=(c[m]||0)+1,i[p]=(i[p]||0)+1,l[f]=(l[f]||0)+1,h="",!(d.items.length>0)){e.next=32;break}return(g=d.items[0]).body.load("text"),e.next=31,t.sync();case 31:h=g.body.text;case 32:a.push({text:u.text.trim(),bold:u.font.bold,italic:u.font.italic,underline:"None"!==u.font.underline,color:m,highlightColor:u.font.highlightColor,hasFootnote:d.items.length>0,footnoteText:h,fontName:p,fontSize:f,hyperlink:u.hyperlink?u.hyperlink.address:null,isFirstWord:0===s,isSecondWord:1===s,isThirdWord:2===s,isLastWord:s===o.items.length-1});case 33:s++,e.next=10;break;case 36:y=Object.entries(c).reduce((function(e,t){return e[1]>t[1]?e:t}))[0],v=Object.entries(i).reduce((function(e,t){return e[1]>t[1]?e:t}))[0],b=Object.entries(l).reduce((function(e,t){return e[1]>t[1]?e:t}))[0],z(a,y,v,b),x=j(a,y,v,b),console.log(x);case 42:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}function z(e,t,n,r){var o=document.getElementById("selected-text-info"),a="<h3>Анализ выделенного текста:</h3>";e.forEach((function(e,o){a+="<h4>Слово ".concat(o+1,": ").concat(e.text,"</h4>"),a+="<p>\n      ".concat(e.bold?"✅":"❌"," Жирный").concat(e.isFirstWord?" (Первое слово)":"","<br>\n      ").concat(e.italic?"✅":"❌"," Курсив").concat(e.isSecondWord?" (Второе слово)":"","<br>\n      ").concat(e.underline?"✅":"❌"," Подчеркнутый<br>\n      ").concat(e.color!==t&&"default"!==e.color?"✅ Особый цвет: ".concat(e.color):"❌ Основной цвет","<br>\n      ").concat(e.highlightColor?"✅ Выделение: ".concat(e.highlightColor):"❌ Без выделения","<br>\n      ").concat(e.hasFootnote?"✅ Есть сноска: ".concat(e.footnoteText).concat(e.isLastWord?" (Последнее слово)":""):"❌ Без сноски","<br>\n      ").concat(e.fontName!==n&&"default"!==e.fontName?"✅ Особый шрифт: ".concat(e.fontName):"❌ Основной шрифт: ".concat(n),"<br>\n      ").concat(e.fontSize!=r&&"default"!==e.fontSize?"✅ Особый размер: ".concat(e.fontSize):"❌ Основной размер: ".concat(r),"<br>\n      ").concat(e.hyperlink?"✅ Ссылка: ".concat(e.hyperlink).concat(e.isThirdWord?" (Третье слово)":""):"❌ Без ссылки","\n    </p>")})),o.innerHTML=a}function P(e,t){return _.apply(this,arguments)}function _(){return(_=a(r().mark((function e(n,o){var a,c,i,l,s,u,d,m;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=o.getTextRanges([" "],!1)).load("items"),e.next=4,n.sync();case 4:c=[],i=t(a.items),e.prev=6,i.s();case 8:if((l=i.n()).done){e.next=27;break}return(s=l.value).load("text, hyperlink"),s.font.load("bold, italic, color, highlightColor, size"),(u=s.footnotes).load("items"),e.next=16,n.sync();case 16:if(!s.text.trim()){e.next=25;break}if(d="",!(u.items.length>0)){e.next=24;break}return(m=u.items[0]).body.load("text"),e.next=23,n.sync();case 23:d=m.body.text;case 24:c.push({text:s.text.trim(),bold:s.font.bold,italic:s.font.italic,color:s.font.color||"black",highlightColor:s.font.highlightColor||"white",size:s.font.size||"11",hasFootnote:u.items.length>0,footnoteText:d,hyperlink:s.hyperlink?s.hyperlink:null});case 25:e.next=8;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(6),i.e(e.t0);case 32:return e.prev=32,i.f(),e.finish(32);case 35:return e.abrupt("return",c);case 36:case"end":return e.stop()}}),e,null,[[6,29,32,35]])})))).apply(this,arguments)}function M(){var e;document.getElementById("prompts").innerHTML='\n        <div class="mt-3">\n            <input type="text" id="prompt-name" class="form-control" placeholder="Название промпта">\n            <select id="prompt-model" class="form-select mt-2"></select>\n            <textarea id="prompt-text" class="form-control mt-2" rows="5" placeholder="Текст промпта"></textarea>\n            <button id="save-prompt" class="btn btn-primary mt-2">Сохранить промпт</button>\n        </div>\n        <div id="prompt-list" class="mt-3"></div>\n    ',$("#prompt-model").select2({width:"100%",placeholder:"Выберите модель"}).on("select2:opening",(function(){setTimeout((function(){$(".select2-search__field").get(0).focus()}),0)})),document.getElementById("save-prompt").onclick=F,H(),e=$("#prompt-model"),JSON.parse(localStorage.getItem("models")||"[]").forEach((function(t){var n=new Option(t.name,t.id,!1,!1);e.append(n)})),e.trigger("change")}function F(){var e=document.getElementById("prompt-name").value,t=$("#prompt-model").val(),n=document.getElementById("prompt-text").value;if(e&&t&&n){var r=c();r.push({name:e,model:t,text:n}),i(r),H(),S(),document.getElementById("prompt-name").value="",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=""}}function H(){var e=document.getElementById("prompt-list"),t=c();e.innerHTML="",t.forEach((function(t,n){var r=document.createElement("div");r.className="mt-2",r.innerHTML="\n            <strong>".concat(t.name,"</strong> (").concat(t.model,')\n            <button class="btn btn-sm btn-primary edit-prompt" data-index="').concat(n,'">Редактировать</button>\n            <button class="btn btn-sm btn-info duplicate-prompt" data-index="').concat(n,'">Дубликат</button>\n            <button class="btn btn-sm btn-danger delete-prompt" data-index="').concat(n,'">Удалить</button>\n        '),e.appendChild(r)})),e.querySelectorAll(".delete-prompt").forEach((function(e){e.onclick=function(){return function(e){var t=c();t.splice(e,1),i(t),H(),S()}(e.dataset.index)}})),e.querySelectorAll(".edit-prompt").forEach((function(e){e.onclick=function(){return t=e.dataset.index,n=c()[t],document.getElementById("prompt-name").value=n.name,$("#prompt-model").val(n.model).trigger("change"),document.getElementById("prompt-text").value=n.text,document.getElementById("save-prompt").textContent="Обновить промпт",void(document.getElementById("save-prompt").onclick=function(){!function(e){var t=document.getElementById("prompt-name").value,n=$("#prompt-model").val(),r=document.getElementById("prompt-text").value;if(t&&n&&r){var o=c();o[e]={name:t,model:n,text:r},i(o),H(),S(),document.getElementById("prompt-name").value="",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=""}}(t),document.getElementById("save-prompt").textContent="Сохранить промпт",document.getElementById("save-prompt").onclick=F});var t,n}})),e.querySelectorAll(".duplicate-prompt").forEach((function(e){e.onclick=function(){return t=e.dataset.index,n=c()[t],document.getElementById("prompt-name").value=n.name+" (копия)",$("#prompt-model").val(null).trigger("change"),document.getElementById("prompt-text").value=n.text,document.getElementById("save-prompt").textContent="Сохранить промпт",void(document.getElementById("save-prompt").onclick=F);var t,n}}))}function J(){document.getElementById("grammar").innerHTML='\n        <div class="mt-3">\n            \x3c!-- Настройки в карточке --\x3e\n            <div class="card">\n                <div class="card-header">\n                    <strong>Настройки проверки</strong>\n                </div>\n                <div class="card-body">\n                    \x3c!-- Модель для проверки --\x3e\n                    <div class="form-group">\n                        <label for="grammar-model">Модель для проверки:</label>\n                        <select id="grammar-model" class="form-control" title="Выберите модель нейросети для проверки текста"></select>\n                    </div>\n                    \x3c!-- Типы проверок --\x3e\n                    <div class="form-group">\n                        <label>Типы проверок:</label>\n                        <div class="form-check">\n                            <input class="form-check-input" type="checkbox" id="check-grammatical" checked>\n                            <label class="form-check-label" for="check-grammatical" title="Проверка на грамматические ошибки">\n                                Грамматические\n                            </label>\n                        </div>\n                        <div class="form-check">\n                            <input class="form-check-input" type="checkbox" id="check-syntactic" checked>\n                            <label class="form-check-label" for="check-syntactic" title="Проверка на синтаксические ошибки">\n                                Синтаксические\n                            </label>\n                        </div>\n                        <div class="form-check">\n                            <input class="form-check-input" type="checkbox" id="check-stylistic" checked>\n                            <label class="form-check-label" for="check-stylistic" title="Проверка на стилистические ошибки">\n                                Стилистические\n                            </label>\n                        </div>\n                        <div class="form-check">\n                            <input class="form-check-input" type="checkbox" id="check-logical" checked>\n                            <label class="form-check-label" for="check-logical" title="Проверка на логические ошибки">\n                                Логические\n                            </label>\n                        </div>\n                    </div>\n                    \x3c!-- Дополнительные настройки --\x3e\n                    <div class="form-group">\n                        <label>Дополнительные опции:</label>\n                        <div class="form-check">\n                            <input class="form-check-input" type="checkbox" id="highlight-checkbox" checked>\n                            <label class="form-check-label" for="highlight-checkbox" title="Выделить проблемный текст в документе">\n                                Выделять проблемный текст\n                            </label>\n                        </div>\n                        <div class="form-check mt-2">\n                            <input class="form-check-input" type="checkbox" id="comment-checkbox" checked>\n                            <label class="form-check-label" for="comment-checkbox" title="Добавить комментарии к проблемному тексту">\n                                Добавлять комментарии к проблемному тексту\n                            </label>\n                        </div>\n                    </div>\n                    <button id="check-grammar" class="btn btn-primary mt-3">Проверить</button>\n                </div>\n            </div>\n        </div>\n        <div id="loading" class="mt-3 text-center" style="display: none;">\n            <div class="spinner-border text-primary" role="status">\n                <span class="sr-only">Загрузка...</span>\n            </div>\n            <button id="cancel-check" class="btn btn-secondary mt-3">Отменить</button>\n        </div>\n        <div id="grammar-results" class="mt-3"></div>\n    ',$("#grammar-model").select2({width:"100%",placeholder:"Выберите модель для проверки"}).on("select2:opening",(function(){setTimeout((function(){$(".select2-search__field").get(0).focus()}),0)})).on("change",(function(){var e=$(this).val();localStorage.setItem("grammarModel",e)})),function(){var e=$("#grammar-model"),t=JSON.parse(localStorage.getItem("models")||"[]");e.empty(),t.forEach((function(t){var n=new Option(t.name,t.id,!1,!1);e.append(n)}));var n=localStorage.getItem("grammarModel");n&&t.some((function(e){return e.id===n}))?e.val(n).trigger("change"):t.length>0&&e.val(t[0].id).trigger("change")}(),function(){var e="false"!==localStorage.getItem("highlightErrors");document.getElementById("highlight-checkbox").checked=e;var t="false"!==localStorage.getItem("addComments");document.getElementById("comment-checkbox").checked=t;var n="false"!==localStorage.getItem("checkGrammatical"),r="false"!==localStorage.getItem("checkSyntactic"),o="false"!==localStorage.getItem("checkStylistic"),a="false"!==localStorage.getItem("checkLogical");document.getElementById("check-grammatical").checked=n,document.getElementById("check-syntactic").checked=r,document.getElementById("check-stylistic").checked=o,document.getElementById("check-logical").checked=a}(),document.getElementById("check-grammar").onclick=R,document.getElementById("highlight-checkbox").onchange=q,document.getElementById("comment-checkbox").onchange=q,document.getElementById("check-grammatical").onchange=q,document.getElementById("check-syntactic").onchange=q,document.getElementById("check-stylistic").onchange=q,document.getElementById("check-logical").onchange=q,document.getElementById("cancel-check").onclick=Y,window.abortController=null}function q(){var e=document.getElementById("highlight-checkbox").checked;localStorage.setItem("highlightErrors",e);var t=document.getElementById("comment-checkbox").checked;localStorage.setItem("addComments",t);var n=document.getElementById("check-grammatical").checked,r=document.getElementById("check-syntactic").checked,o=document.getElementById("check-stylistic").checked,a=document.getElementById("check-logical").checked;localStorage.setItem("checkGrammatical",n),localStorage.setItem("checkSyntactic",r),localStorage.setItem("checkStylistic",o),localStorage.setItem("checkLogical",a)}function R(){return G.apply(this,arguments)}function G(){return G=a(r().mark((function e(){var t,n,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,re(!0),window.abortController=new AbortController,e.next=5,Word.run(function(){var e=a(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load("text"),e.next=4,t.sync();case 4:return e.abrupt("return",n.text.trim());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:if(!((t=e.sent).length>0)){e.next=16;break}return n=$("#grammar-model").val(),e.next=10,U(t,n,window.abortController.signal);case 10:return X(o=e.sent),e.next=14,te(o);case 14:e.next=19;break;case 16:console.log("Текст не выделен"),document.getElementById("grammar-results").innerHTML='<p class="text-warning">Пожалуйста, выделите текст для проверки.</p>',re(!1);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),"AbortError"===e.t0.name?(console.log("Проверка отменена пользователем."),document.getElementById("grammar-results").innerHTML='<p class="text-info">Проверка отменена.</p>'):(console.error("Error in checkGrammar:",e.t0),document.getElementById("grammar-results").innerHTML='<p class="text-danger">Произошла ошибка при проверке. Пожалуйста, попробуйте еще раз.</p>');case 24:return e.prev=24,re(!1),window.abortController=null,e.finish(24);case 28:case"end":return e.stop()}}),e,null,[[0,21,24,28]])}))),G.apply(this,arguments)}function Y(){window.abortController&&(window.abortController.abort(),re(!1),window.abortController=null)}function U(e,t,n){return K.apply(this,arguments)}function K(){return(K=a(r().mark((function e(t,n,o){var a,c,i,l,s,u,d,m;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=localStorage.getItem("apiKey"),c=[],i={},document.getElementById("check-grammatical").checked&&(c.push("грамматические"),i["грамматическая"]=!0),document.getElementById("check-syntactic").checked&&(c.push("синтаксические"),i["синтаксическая"]=!0),document.getElementById("check-stylistic").checked&&(c.push("стилистические"),i["стилистическая"]=!0),document.getElementById("check-logical").checked&&(c.push("логические"),i["логическая"]=!0),0!==c.length){e.next=9;break}throw new Error("Не выбраны типы проверок");case 9:return l=c.join(", "),s="Ты - опытный редактор и лингвист. Твоя задача - проанализировать предоставленный текст и найти только следующие типы ошибок: ".concat(l,'.\n\nТвои инструкции:\n\n- Анализируй текст на уровне предложений и отдельных слов.\n\n- Ищи только указанные типы ошибок.\n\n- Игнорируй другие типы ошибок.\n\n- Возвращай результат в формате JSON-массива, где каждый элемент содержит:\n  1. "text": проблемный фрагмент текста (слово, фраза или предложение).\n  2. "comment": объяснение проблемы.\n  3. "suggestion": конкретное предложение по улучшению.\n  4. "errorType": тип ошибки (').concat(Object.keys(i).map((function(e){return'"'.concat(e,'"')})).join(", "),").\n\nПример ответа:\n\n").concat((r=Object.keys(i),p=void 0,p=[],r.includes("грамматическая")&&p.push('{\n    "text": "Она сказал",\n    "comment": "Неправильное согласование рода в глаголе.",\n    "suggestion": "Она сказала",\n    "errorType": "грамматическая"\n}'),r.includes("синтаксическая")&&p.push('{\n    "text": "Когда я пришёл домой, потому что было поздно.",\n    "comment": "Неправильное построение предложения, лишний союз "потому что" без главной части.",\n    "suggestion": "Когда я пришёл домой, было поздно.",\n    "errorType": "синтаксическая"\n}'),r.includes("стилистическая")&&p.push('{\n    "text": "Я пошёл в магазин и купил хлеб",\n    "comment": "Использование разговорного стиля в формальном тексте.",\n    "suggestion": "Я отправился в магазин и приобрёл хлеб.",\n    "errorType": "стилистическая"\n}'),r.includes("логическая")&&p.push('{\n    "text": "Стол был настолько маленький, что на нём поместилась вся мебель.",\n    "comment": "Логическое противоречие: маленький стол не может вместить всю мебель.",\n    "suggestion": "Комната была настолько большой, что в ней поместилась вся мебель.",\n    "errorType": "логическая"\n}'),"[\n  ".concat(p.join(",\n  "),"\n]")),"\n\nВажно:\n\n- Возвращай *только* JSON-массив без дополнительных пояснений или предисловий.\n\n- Если ошибок нет, верни пустой массив: []"),u='Пожалуйста, проанализируй следующий текст:\n\n"'.concat(t,'"'),e.prev=12,e.next=15,fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json","HTTP-Referer":"https://www.office.com","X-Title":"Word Grammar Checker"},body:JSON.stringify({model:n,messages:[{role:"system",content:s},{role:"user",content:u}]}),signal:o});case 15:if((d=e.sent).ok){e.next=18;break}throw new Error("HTTP error! status: ".concat(d.status));case 18:return e.next=20,d.json();case 20:return m=e.sent,console.log(m.choices[0].message.content.trim()),e.abrupt("return",JSON.parse(m.choices[0].message.content.trim()));case 25:if(e.prev=25,e.t0=e.catch(12),"AbortError"!==e.t0.name){e.next=32;break}throw console.log("Запрос был отменен."),e.t0;case 32:throw console.error("Error in analyzeText:",e.t0),e.t0;case 34:case"end":return e.stop()}var r,p}),e,null,[[12,25]])})))).apply(this,arguments)}function X(e){var n=document.getElementById("grammar-results");if(n.innerHTML="",0!==e.length){var r={};e.forEach((function(e,t){var n=e.errorType||"Другие";r[n]||(r[n]=[]),e.index=t,r[n].push(e)}));var o="grammarAccordion",a='<div class="accordion" id="'.concat(o,'">');Object.keys(r).forEach((function(e,t){var n=r[e],c="collapse".concat(t);a+='\n            <div class="card">\n                <div class="card-header" id="heading'.concat(t,'">\n                    <h2 class="mb-0">\n                        <button class="btn btn-link ').concat(0===t?"":"collapsed",'" type="button" data-toggle="collapse" data-target="#').concat(c,'" aria-expanded="').concat(0===t?"true":"false",'" aria-controls="').concat(c,'">\n                            ').concat(e.charAt(0).toUpperCase()+e.slice(1),' ошибки (<span class="error-count">').concat(n.length,'</span>)\n                        </button>\n                    </h2>\n                </div>\n                <div id="').concat(c,'" class="collapse ').concat(0===t?"show":"",'" aria-labelledby="heading').concat(t,'" data-parent="#').concat(o,'">\n                    <div class="card-body">\n                        ').concat(n.map((function(t,r){return'\n                            <div class="mb-3 p-3 border error-card '.concat(r<n.length-1?"border-bottom":"",'" data-error-index="').concat(t.index,'" data-error-type="').concat(e,'">\n                                <p><strong>Проблемный текст:</strong> <span class="text-danger">').concat(t.text,"</span></p>\n                                <p><strong>Комментарий:</strong> ").concat(t.comment,'</p>\n                                <p><strong>Предложение:</strong> <span class="text-success">').concat(t.suggestion,'</span></p>\n                                <button class="btn btn-sm btn-primary apply-suggestion" data-error-index="').concat(t.index,'">Применить исправление</button>\n                            </div>\n                        ')})).join(""),"\n                    </div>\n                </div>\n            </div>\n        ")})),a+="</div>",n.innerHTML=a;var c,i=t(document.getElementsByClassName("apply-suggestion"));try{for(i.s();!(c=i.n()).done;)c.value.addEventListener("click",(function(){D(parseInt(this.dataset.errorIndex,10),e,this)}))}catch(e){i.e(e)}finally{i.f()}}else n.innerHTML='<p class="text-success">Ошибок не найдено. Текст выглядит хорошо!</p>'}function D(e,t,n){return Q.apply(this,arguments)}function Q(){return Q=a(r().mark((function e(n,o,c){var i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o[n]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Word.run(function(){var e=a(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load("text"),e.next=4,t.sync();case 4:return e.abrupt("return",n.text.trim());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:if(0!==e.sent.length){e.next=9;break}return V(c,"Пожалуйста, выделите текст для применения исправления."),e.abrupt("return");case 9:return e.next=11,Word.run(function(){var e=a(r().mark((function e(n){var o,a,l,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.document.getSelection(),(a=o.search(i.text,{matchCase:!0,matchWholeWord:!1})).load("items"),n.trackedObjects.add(a),e.next=6,n.sync();case 6:if(!(a.items.length>0)){e.next=15;break}l=t(a.items);try{for(l.s();!(s=l.n()).done;)s.value.insertText(i.suggestion,Word.InsertLocation.replace)}catch(e){l.e(e)}finally{l.f()}return e.next=11,n.sync();case 11:Z(i.index),ee(i.errorType),e.next=16;break;case 15:V(c,"Не удалось найти текст для замены. Убедитесь, что выделили правильный текст.");case 16:n.trackedObjects.remove(a);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error:",e)}));case 11:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function V(e,t){if(e){var n=e.parentElement.querySelector(".error-message");n&&n.remove();var r=document.createElement("div");r.className="error-message text-danger mt-2",r.textContent=t,e.parentElement.insertBefore(r,e.nextSibling)}}function Z(e){var n,r=t(document.getElementsByClassName("error-card"));try{for(r.s();!(n=r.n()).done;){var o=n.value;if(parseInt(o.dataset.errorIndex,10)===e){o.parentNode.removeChild(o);break}}}catch(e){r.e(e)}finally{r.f()}}function ee(e){var n,r=t(document.querySelectorAll(".card-header"));try{for(r.s();!(n=r.n()).done;){var o=n.value,a=o.querySelector("button");if(a&&a.textContent.includes(e)){var c=a.querySelector(".error-count"),i=parseInt(c.textContent,10);if(i>1)c.textContent=i-1;else{var l=o.parentElement;l.parentNode.removeChild(l)}break}}}catch(e){r.e(e)}finally{r.f()}}function te(e){return ne.apply(this,arguments)}function ne(){return ne=a(r().mark((function e(n){var o,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=document.getElementById("highlight-checkbox").checked,c=document.getElementById("comment-checkbox").checked,o||c){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Word.run(function(){var e=a(r().mark((function e(a){var i,l,s,u,d,m,p,f;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=a.document.getSelection(),l=t(n),e.prev=2,l.s();case 4:if((s=l.n()).done){e.next=19;break}return u=s.value,(d=i.search(u.text,{matchCase:!0,matchWholeWord:!1})).load("items"),a.trackedObjects.add(d),e.next=11,a.sync();case 11:if(!(d.items.length>0)){e.next=16;break}m=t(d.items);try{for(m.s();!(p=m.n()).done;)f=p.value,o&&(f.font.highlightColor="yellow"),c&&f.insertComment("Тип ошибки: ".concat(u.errorType,"\nКомментарий: ").concat(u.comment,"\nПредложение: ").concat(u.suggestion))}catch(e){m.e(e)}finally{m.f()}return e.next=16,a.sync();case 16:a.trackedObjects.remove(d);case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),l.e(e.t0);case 24:return e.prev=24,l.f(),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[2,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error:",e)}));case 6:case"end":return e.stop()}}),e)}))),ne.apply(this,arguments)}function re(e){var t=document.getElementById("loading"),n=document.getElementById("check-grammar");e?(t.style.display="block",n.disabled=!0):(t.style.display="none",n.disabled=!1)}Office.onReady((function(e){e.host===Office.HostType.Word&&(w(),M(),l(),J())})),document.addEventListener("DOMContentLoaded",(function(){w(),M(),l(),J()}))}(),function(){"use strict";var e=n(14385),t=n.n(e),r=new URL(n(54058),n.b);t()(r)}()}();
//# sourceMappingURL=taskpane.js.map